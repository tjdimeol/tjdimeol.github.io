<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Computer Vision Project 2 - Image Homography and Warping</title>
    <style>
        body {
            font-family: 'Georgia', 'Times New Roman', serif;
            max-width: 900px;
            margin: 40px auto;
            padding: 20px;
            line-height: 1.6;
            color: #333;
            background-color: #fafafa;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            border-bottom: 2px solid #333;
            padding-bottom: 20px;
        }

        h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
        }

        .author-info {
            font-size: 1.1em;
            color: #666;
        }

        h2 {
            font-size: 1.8em;
            margin-top: 40px;
            margin-bottom: 20px;
            color: #2c3e50;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
        }

        h3 {
            font-size: 1.4em;
            margin-top: 30px;
            margin-bottom: 15px;
            color: #34495e;
        }

        p {
            margin-bottom: 15px;
            text-align: justify;
        }

        .figure {
            margin: 30px 0;
            text-align: center;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .figure img {
            max-width: 100%;
            height: auto;
            border-radius: 4px;
        }

        .figure-caption {
            margin-top: 15px;
            font-style: italic;
            color: #555;
            font-size: 0.95em;
        }

        .gif-figure {
            margin: 30px 0;
            text-align: center;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            border: 2px solid #3498db;
        }

        code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .equation {
            text-align: center;
            margin: 20px 0;
            font-style: italic;
        }

        .method-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .method-box {
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .method-box h4 {
            margin-top: 0;
            color: #2980b9;
        }

        ul {
            margin-left: 20px;
        }

        li {
            margin-bottom: 8px;
        }

        .conclusion {
            background-color: #ecf0f1;
            padding: 20px;
            border-left: 4px solid #3498db;
            margin: 30px 0;
            border-radius: 4px;
        }

        footer {
            margin-top: 60px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            text-align: center;
            color: #777;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <header>
        <h1>Computer Vision Project 2</h1>
        <h2 style="border:none; margin-top:10px;">Image Homography and Warping</h2>
        <div class="author-info">
            <p><strong>Taylor DiMeola</strong><br>
            CSCI 581 - Computer Vision<br>
            University of Mississippi<br>
            October 18, 2025</p>
        </div>
    </header>

    <section id="abstract">
        <h2>Abstract</h2>
        <p>This report presents implementations and analyses of homography-based image transformations and warping techniques. Part 1 demonstrates image rectification using the Direct Linear Transform (DLT) algorithm to compute homography matrices from point correspondences. Part 2 explores creative applications through AR-style texture replacement on planar surfaces in real-world photographs. Part 3 provides a comprehensive comparison of triangular mesh warping and thin-plate spline (TPS) warping methods, including a bonus animated demonstration of cardiac muscle contraction using interpolated control points. Results demonstrate the practical applications of these techniques in computer vision tasks ranging from perspective correction to artistic image manipulation.</p>
    </section>

    <section id="part1">
        <h2>Part 1: Image Rectification Using Homography</h2>

        <h3>1.1 Overview</h3>
        <p>The goal of Part 1 is to rectify a tilted planar surface to a fronto-parallel view using homography transformation. A homography is a projective transformation that maps points between two planes and can be represented as a 3×3 matrix <strong>H</strong>.</p>

        <h3>1.2 Direct Linear Transform (DLT) Algorithm</h3>
        <p>The DLT algorithm computes the homography matrix from point correspondences between source and destination images. Given n point pairs (x<sub>i</sub>, y<sub>i</sub>) → (x'<sub>i</sub>, y'<sub>i</sub>), the algorithm constructs a system of linear equations:</p>

        <div class="equation">
            <strong>Ah = 0</strong>
        </div>

        <p>where <strong>A</strong> is a 2n×9 matrix and <strong>h</strong> is the vectorized homography. Each correspondence contributes two rows to the matrix:</p>

        <ul>
            <li>Row 1: [-x, -y, -1, 0, 0, 0, x·x', y·x', x']</li>
            <li>Row 2: [0, 0, 0, -x, -y, -1, x·y', y·y', y']</li>
        </ul>

        <p>The solution is obtained using Singular Value Decomposition (SVD): <strong>A = UΣV<sup>T</sup></strong>. The homography vector <strong>h</strong> corresponds to the last row of <strong>V<sup>T</sup></strong> (the right singular vector with the smallest singular value). This 9-element vector is then reshaped into a 3×3 matrix and normalized so that H[2,2] = 1.</p>

        <h3>1.3 Implementation</h3>
        <p>The implementation consists of two main components:</p>
        <ul>
            <li><code>4corners.py</code>: Interactive tool for selecting 4 corner points from the tilted image</li>
            <li><code>part1_a.py</code>: Computes homography using DLT and warps the image using <code>cv2.warpPerspective()</code></li>
        </ul>

        <h3>1.4 Results</h3>
        <p>The rectification was tested on a tilted photograph. Four corner points were selected from the tilted plane, and corresponding destination points were defined as a rectangle. The resulting transformation successfully converted the perspective-distorted image to a fronto-parallel view.</p>

        <div class="figure">
            <img src="images/homography.jpg" alt="Rectified Image Result">
            <div class="figure-caption"><strong>Figure 1:</strong> Original tilted image (left) and rectified result (right) showing successful perspective correction using DLT homography.</div>
        </div>
    </section>

    <section id="part2">
        <h2>Part 2: AR Texture Replacement</h2>

        <h3>2.1 Overview</h3>
        <p>Part 2 demonstrates creative applications of homography through augmented reality-style texture replacement. The goal is to map custom textures onto planar surfaces in real-world photographs, creating psychedelic or artistic effects.</p>

        <h3>2.2 Approach</h3>
        <p>Unlike Part 1's 4-point homography, this implementation uses polygon-based selection to handle irregular surface boundaries. The workflow consists of:</p>
        <ol>
            <li>Interactive polygon selection tool that allows clicking unlimited points to trace surface boundaries</li>
            <li>Mask creation using <code>cv2.fillPoly()</code> to define the target region</li>
            <li>Texture resizing to fit the bounding box of the selected polygon</li>
            <li>Pixel-wise texture mapping within the masked region</li>
        </ol>

        <h3>2.3 Implementation: <code>texture_mapper_polygon.py</code></h3>
        <p>The tool allows flexible selection of arbitrary polygonal regions:</p>
        <ul>
            <li>Click points around the desired surface boundary</li>
            <li>Press ENTER when selection is complete</li>
            <li>The polygon is filled with the chosen texture, scaled to fit the bounding box</li>
        </ul>

        <h3>2.4 Results: Psychedelic Hallway Progression</h3>
        <p>A series of five hallway images were progressively textured with vibrant patterns, creating an increasingly surreal environment. Each iteration added textures to different surfaces (walls, ceiling, doors, floor).</p>

        <div class="figure">
            <img src="images/halltex1.jpg" alt="Hallway Texture 1">
            <div class="figure-caption"><strong>Figure 2a:</strong> Initial texture application - left wall with psychedelic pattern.</div>
        </div>

        <div class="figure">
            <img src="images/halltex2.jpg" alt="Hallway Texture 2">
            <div class="figure-caption"><strong>Figure 2b:</strong> Progressive texturing - right wall added.</div>
        </div>

        <div class="figure">
            <img src="images/halltex3.jpg" alt="Hallway Texture 3">
            <div class="figure-caption"><strong>Figure 2c:</strong> Ceiling texture applied, creating immersive effect.</div>
        </div>

        <div class="figure">
            <img src="images/halltex4.jpg" alt="Hallway Texture 4">
            <div class="figure-caption"><strong>Figure 2d:</strong> Door textures added for additional detail.</div>
        </div>

        <div class="figure">
            <img src="images/textured_hall.jpg" alt="Hallway Texture 5">
            <div class="figure-caption"><strong>Figure 2e:</strong> Final result - complete psychedelic hallway with floor texture.</div>
        </div>

        <h3>2.5 Discussion</h3>
        <p>The polygon-based approach proved superior to 4-point homography for this application because:</p>
        <ul>
            <li>Real-world surfaces often have irregular boundaries (doorframes, wall edges, occlusions)</li>
            <li>Unlimited points allow precise tracing of complex shapes</li>
            <li>Mask-based filling ensures texture stays within intended regions</li>
        </ul>
        <p>The psychedelic hallway demonstrates how simple texture mapping can create dramatic artistic effects, showing potential applications in virtual production, interior design visualization, and creative digital art.</p>
    </section>

    <section id="part3">
        <h2>Part 3: Warping Method Comparison</h2>

        <h3>3.1 Overview</h3>
        <p>Part 3 compares two fundamentally different warping approaches: triangular mesh warping and thin-plate spline (TPS) warping. Both methods transform images based on control point correspondences, but differ significantly in their mathematical foundations and resulting deformations.</p>

        <h3>3.2 Control Point Selection</h3>
        <p>A custom tool (<code>mesh_points.py</code>) was created to select control point pairs interactively. The tool alternates between source and destination clicks, allowing the user to define how specific image regions should be transformed. For the heart contraction demonstration, 12 control point pairs were carefully placed around the heart's anatomical features to simulate natural muscle contraction.</p>

        <h3>3.3 Triangular Mesh Warping</h3>
        <p><strong>Method:</strong> Uses Delaunay triangulation to partition the image into non-overlapping triangles. Each triangle is warped independently using an affine transformation computed from the three vertex correspondences.</p>

        <p><strong>Algorithm:</strong></p>
        <ol>
            <li>Compute Delaunay triangulation on source control points (with image corners added for full coverage)</li>
            <li>For each triangle:
                <ul>
                    <li>Extract source and destination triangle vertices</li>
                    <li>Compute affine transform matrix using <code>cv2.getAffineTransform()</code></li>
                    <li>Warp the triangle region using <code>cv2.warpAffine()</code></li>
                    <li>Blend into output image using triangle mask</li>
                </ul>
            </li>
        </ol>

        <p><strong>Characteristics:</strong></p>
        <ul>
            <li><strong>Local deformation:</strong> Changes to one control point only affect adjacent triangles</li>
            <li><strong>C<sup>0</sup> continuity:</strong> Continuous but not smooth at triangle boundaries (potential visible seams)</li>
            <li><strong>Computational efficiency:</strong> Fast - each triangle computed independently</li>
            <li><strong>Stability:</strong> Robust to extreme control point displacements</li>
        </ul>

        <h3>3.4 Thin-Plate Spline (TPS) Warping</h3>
        <p><strong>Method:</strong> Uses radial basis functions to create a smooth, globally continuous deformation field. Models the image as a thin metal plate that bends to pass through the control points with minimal bending energy.</p>

        <p><strong>Algorithm:</strong></p>
        <ol>
            <li>Create RBF interpolators for x and y coordinates using scipy's <code>Rbf()</code> with <code>function='thin_plate'</code></li>
            <li>Generate dense coordinate grid covering entire image</li>
            <li>Compute warped coordinates for every pixel using the interpolator</li>
            <li>Remap image using <code>cv2.remap()</code> with bilinear interpolation</li>
        </ol>

        <p><strong>Characteristics:</strong></p>
        <ul>
            <li><strong>Global deformation:</strong> Every control point influences the entire image</li>
            <li><strong>C<sup>∞</sup> smoothness:</strong> Infinitely differentiable, no visible seams</li>
            <li><strong>Computational cost:</strong> Slower - requires solving global system and dense grid evaluation</li>
            <li><strong>Sensitivity:</strong> Distant control points can cause unexpected deformations in unrelated regions</li>
        </ul>

        <h3>3.5 Comparative Results</h3>

        <div class="figure">
            <img src="images/warping_comparison.jpg" alt="Warping Methods Comparison">
            <div class="figure-caption"><strong>Figure 3:</strong> Side-by-side comparison of original image (left), triangular mesh warping (center), and TPS warping (right). Note the smoother appearance of TPS but more localized control of mesh warping.</div>
        </div>

        <div class="method-comparison">
            <div class="method-box">
                <h4>Triangular Mesh Warping</h4>
                <ul>
                    <li><strong>Pros:</strong>
                        <ul>
                            <li>Fast computation</li>
                            <li>Predictable local behavior</li>
                            <li>Handles extreme deformations well</li>
                        </ul>
                    </li>
                    <li><strong>Cons:</strong>
                        <ul>
                            <li>Potential visible seams at triangle edges</li>
                            <li>Less smooth overall appearance</li>
                        </ul>
                    </li>
                    <li><strong>Best for:</strong> Real-time applications, face morphing, controlled local edits</li>
                </ul>
            </div>

            <div class="method-box">
                <h4>TPS Warping</h4>
                <ul>
                    <li><strong>Pros:</strong>
                        <ul>
                            <li>Perfectly smooth results</li>
                            <li>Natural-looking deformations</li>
                            <li>No visible artifacts</li>
                        </ul>
                    </li>
                    <li><strong>Cons:</strong>
                        <ul>
                            <li>Slower computation</li>
                            <li>Global sensitivity - distant points can interfere</li>
                            <li>Requires careful control point placement</li>
                        </ul>
                    </li>
                    <li><strong>Best for:</strong> Medical imaging, artistic effects, high-quality offline rendering</li>
                </ul>
            </div>
        </div>

        <h3>3.6 Experimental Observations</h3>
        <p>During experimentation with control point placement on the heart image, I discovered critical differences in behavior:</p>
        <ul>
            <li><strong>Circular ring pattern:</strong> Placing control points in a circular ring around the heart created extreme, unnatural deformations with TPS due to global influence, while mesh warping remained stable.</li>
            <li><strong>Anatomical placement:</strong> Carefully placing points along the heart's natural anatomical features (apex, ventricles, atria) produced realistic contraction with both methods, but TPS appeared smoother.</li>
            <li><strong>Computational cost:</strong> Triangular mesh warping completed in ~0.05 seconds, while TPS took ~2.5 seconds for the same image.</li>
        </ul>

        <h3>3.7 Bonus: Beating Heart Animation</h3>
        <p>To demonstrate practical applications of warping interpolation, I created an animated sequence simulating cardiac contraction. The implementation uses linear interpolation between control point states to generate intermediate frames.</p>

        <p><strong>Animation Pipeline:</strong></p>
        <ol>
            <li>Define two control point sets: relaxed (diastole) and contracted (systole)</li>
            <li>Generate intermediate frames using <code>interpolate_points(pts1, pts2, alpha)</code> where alpha ∈ [0, 1]</li>
            <li>Create 3-frame sequence: original (α=0), halfway (α=0.5), fully contracted (α=1)</li>
            <li>Construct beat pattern: 1→2→3→2→1 and loop 10 times</li>
            <li>Export as GIF using imageio with 0.15s per frame</li>
        </ol>

        <div class="gif-figure">
            <img src="images/heart_beat.gif" alt="Beating Heart Animation">
            <div class="figure-caption"><strong>Figure 4:</strong> Animated beating heart created using interpolated triangular mesh warping. The animation demonstrates realistic cardiac muscle contraction through carefully placed anatomical control points.</div>
        </div>

        <p><strong>Technical Details:</strong></p>
        <ul>
            <li>12 control point pairs placed on anatomical landmarks (apex, left ventricle, right ventricle, atria, valves)</li>
            <li>Triangular mesh warping used for stability and speed (allows real-time playback)</li>
            <li>Linear interpolation in control point space creates smooth motion</li>
            <li>Looping sequence creates continuous heartbeat effect</li>
        </ul>

        <p>This animation demonstrates how warping techniques can be applied to medical visualization, educational tools, and scientific animation. The smooth contraction achieved through interpolation shows potential for creating synthetic training data for cardiac imaging analysis.</p>
    </section>

    <section id="conclusion">
        <h2>Conclusion</h2>
        <div class="conclusion">
            <p>This project explored three fundamental applications of geometric image transformations. Part 1 demonstrated perspective rectification using DLT homography, a foundational technique in computer vision used for document scanning, architectural photography, and camera calibration. Part 2 showcased creative texture mapping for artistic augmented reality effects, illustrating how simple transformations can create compelling visual experiences. Part 3 provided a rigorous comparison of triangular mesh and TPS warping methods, revealing the trade-offs between computational efficiency and smoothness quality.</p>

            <p>The key insights from this work are:</p>
            <ul>
                <li><strong>Homography:</strong> Powerful for planar transformations, requiring only 4 correspondences, widely applicable in AR, panorama stitching, and geometric correction</li>
                <li><strong>Triangular Mesh Warping:</strong> Ideal for real-time applications requiring local control, such as face morphing, interactive image editing, and video stabilization</li>
                <li><strong>TPS Warping:</strong> Superior for applications demanding smooth, natural deformations, such as medical image registration, scientific visualization, and high-quality artistic effects</li>
            </ul>

            <p>The beating heart animation demonstrates that these techniques extend beyond static image manipulation to create dynamic, physics-inspired animations suitable for educational and medical visualization. Future work could explore hybrid approaches combining the speed of mesh warping with the smoothness of TPS, or investigate learning-based warping methods using neural networks.</p>
        </div>
    </section>

    <section id="code">
        <h2>Code Repository</h2>
        <p>All source code, tools, and test images are available in the project repository:</p>
        <ul>
            <li><code>4corners.py</code> - Interactive 4-point selection tool</li>
            <li><code>part1_a.py</code> - DLT homography computation and rectification</li>
            <li><code>texture_mapper_polygon.py</code> - Polygon-based texture mapping tool</li>
            <li><code>mesh_points.py</code> - Control point selection for warping</li>
            <li><code>part3_warping_comparison.py</code> - Triangular mesh vs TPS implementation</li>
            <li><code>heart_beat_animation.py</code> - Animated heart generation script</li>
        </ul>
    </section>

    <footer>
        <p>Computer Vision CSCI 581 - Project 2<br>
        Taylor DiMeola | University of Mississippi | October 2025</p>
    </footer>
</body>
</html>
